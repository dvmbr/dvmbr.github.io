---
import { type Tone, type Tag, TAGS, TONE_CLASS } from "../../data/tags";
import TagPills from "../TagPills.astro";

type Principle = {
  no: string;
  accent: "mint" | "red";
  hoverBg: "brand-red" | "brand-mint";
  title: string;
  descHtml: string; // <br /> 포함
};

const PRINCIPLES: Principle[] = [
  {
    no: "01/",
    accent: "mint",
    hoverBg: "brand-red",
    title: "State-Oriented Thinking",
    descHtml: `Design flows around explicit states,<br />making every UI transition predictable.`,
  },
  {
    no: "02/",
    accent: "red",
    hoverBg: "brand-mint",
    title: "Feedback as a First-Class Citizen",
    descHtml: `Every user action deserves a response,<br />including delay, success, and failure.`,
  },
  {
    no: "03/",
    accent: "red",
    hoverBg: "brand-mint",
    title: "Structured Interfaces",
    descHtml: `Components and interfaces are built<br />with extension and replacement in mind.`,
  },
  {
    no: "04/",
    accent: "mint",
    hoverBg: "brand-red",
    title: "Sustainable Codebases",
    descHtml: `Favor structures that last,<br />not just solutions that ship fast.`,
  },
];

const ACCENT_CLASS = {
  mint: "text-brand-mint group-hover:text-space-900",
  red: "text-brand-red group-hover:text-space-900",
} as const;

const HOVER_BG_CLASS = {
  "brand-red": "hover:bg-brand-red",
  "brand-mint": "hover:bg-brand-mint",
  "space-950": "hover:bg-space-950",
} as const;

function tonesForPrinciple(no: string): Tone[] {
  switch (no) {
    case "01/":
      return ["philosophy", "core"];

    case "02/":
      return ["interaction", "secondary"];

    case "03/":
      return ["architecture", "core"];

    case "04/":
      return ["quality", "secondary"];

    default:
      return ["secondary"];
  }
}

function getPrincipleTags(no: string): Tag[] {
  const tones = tonesForPrinciple(no);
  return TAGS.filter((t) => tones.includes(t.tone));
}
---

<section
  class="bg-accent-slate border-divider grid grid-cols-1 gap-px border-t md:grid-cols-2"
>
  {
    PRINCIPLES.map((p) => (
      <article
        class={`bg-space-900 group p-10 transition-[background-color,transform,box-shadow] duration-500 ease-out hover:-translate-y-0.5 hover:shadow-[0_18px_60px_rgba(0,0,0,0.28)] md:p-12 ${HOVER_BG_CLASS[p.hoverBg]}`}
      >
        <span
          class={`${ACCENT_CLASS[p.accent]} font-mono text-sm transition-[color,transform,opacity] duration-500 group-hover:-translate-y-px group-hover:opacity-95`}
        >
          {p.no}
        </span>

        <h2 class="text-ink-main group-hover:text-space-900 mt-4 text-3xl font-black transition-[color,transform] duration-500 group-hover:-translate-y-px md:text-4xl">
          {p.title}
        </h2>

        <p
          class="text-ink-sub group-hover:text-space-900/80 mt-4 leading-relaxed transition-[color,transform,opacity] duration-500 group-hover:translate-y-px group-hover:opacity-95"
          set:html={p.descHtml}
        />

        <div class="mt-6">
          <TagPills tags={getPrincipleTags(p.no)} toneClass={TONE_CLASS} />
        </div>
      </article>
    ))
  }
</section>

<style>
  article.group:hover :global(.tag-list) :global(.tag-pill) {
    border-color: rgba(0, 0, 0, 0.22);
    background-color: rgba(255, 255, 255, 0.14);
    color: rgba(3, 3, 4, 0.9);
  }

  article.group:hover :global(.tag-list) :global(.tag-pill:hover),
  article.group:hover :global(.tag-list) :global(.group:hover .tag-pill),
  article.group:hover :global(.tag-list) :global(.tag-pill:focus-visible) {
    border-color: rgba(0, 0, 0, 0.32);
    background-color: rgba(255, 255, 255, 0.22);
  }

  article.group:hover :global(.tag-list) :global(.tag-tooltip) {
    background: rgba(3, 3, 4, 0.92);
    border-color: rgba(255, 255, 255, 0.14);
  }

  article.group:hover :global(.tag-list) :global(.tag-tooltip__arrow) {
    background: rgba(3, 3, 4, 0.92);
    border-left-color: rgba(255, 255, 255, 0.14);
    border-top-color: rgba(255, 255, 255, 0.14);
  }
</style>
